<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Test</title>
        <script src="https://d3js.org/d3.v4.js"></script>
        <!--Got some template advice from https://github.com/fletchjeff/zacartogram/blob/master/index.html-->
       
        <style type="text/css">
        body {
            font-family:'Open Sans', sans-serif;
            font-weight: 300;
            font-size: 14px;
            line-height: 1.4em;
            padding-top: 20px;
            margin: 0 auto;
            width: 600px;
        }

       
        
    </style>
    </head>
    <body>
    <!--<div id="map-container">
        <svg id="map"></svg>
    </div>-->
        <button id="1940Button" onclick="dataChanging(1940)" >1940</button>
        <button id="1944Button" onclick="dataChanging(1944)" >1944</button>
        <button id="1948Button" onclick="dataChanging(1948)" >1948</button>
        <button id="1952Button" onclick="dataChanging(1952)" >1952</button>
        <button id="1956Button" onclick="dataChanging(1956)" >1956</button>
        <button id="1960Button" onclick="dataChanging(1960)" >1960</button>
        <button id="1964Button" onclick="dataChanging(1964)" >1964</button>
        <button id="1968Button" onclick="dataChanging(1968)" >1968</button>
        <button id="1972Button" onclick="dataChanging(1972)" >1972</button>
        <button id="1976Button" onclick="dataChanging(1976)" >1976</button>
        <button id="1980Button" onclick="dataChanging(1980)" >1980</button>
        <button id="1984Button" onclick="dataChanging(1984)" >1984</button>
        <button id="1988Button" onclick="dataChanging(1988)" >1988</button>
        <button id="1992Button" onclick="dataChanging(1992)" >1992</button>
        <button id="1996Button" onclick="dataChanging(1996)" >1996</button>
        <button id="2000Button" onclick="dataChanging(2000)" >2000</button>
        <button id="2004Button" onclick="dataChanging(2004)" >2004</button>
        <button id="2008Button" onclick="dataChanging(2008)" >2008</button>
        <button id="2012Button" onclick="dataChanging(2012)" >2012</button>
        <button id="2016Button" onclick="dataChanging(2016)" >2016</button>


    
        
        <script src="cartogram.js"></script>
        <script type="text/javascript">
            //d3 code here!
// d3.select("body").append("h1").style("color","red").text("Manipulating DOM elements in D3");
// d3.select("body").append("p").style("color","green").style("font-size","32px").text("Where is the visualization?");


        

var canvasW = 1200;
var canvasH = 1200;

const images = {
    'HILARY CLINTON': "presidentImages/clinton.jpg",
    'DONALD TRUMP': "presidentImages/trump.jpg",
    'BARACK OBAMA': "presidentImages/obama.jpg",
    'JOHN McCAIN': "presidentImages/mccain.jpg",
    'MITT ROMNEY': "presidentImages/romney.jpg",
    'GEORGE W. BUSH': "presidentImages/bush.jpg",
    'JOHN KERRY': "presidentImages/kerry.jpg",
    'ROBERT DOLEÂ ': "presidentImages/dole.jpg",
    'BILL CLINTON': "presidentImages/billclinton.jpg",
    'AL GORE': "presidentImages/gore.jpg",
    'MICHAEL S. DUKAKIS': "presidentImages/dukakis.jpg",
    'WALTER MONDALE': "presidentImages/mondale.jpg",
    'RONALD REAGAN': "presidentImages/reagan.jpg",
    'GEORGE BUSH': "presidentImages/hwbush.jpg",
    'JIMMY CARTER': "presidentImages/carter.jpg",
    'GERALD R. FORD': "presidentImages/ford.jpg",
    'RICHARD NIXON': "presidentImages/nixon.jpg",
    'HUBERT HUMPHREY': "presidentImages/humphrey.jpg",
    'GEORGE McGOVERN': "presidentImages/mcgovern.jpg",
    'LYNDON B. JOHNSON': "presidentImages/johnson.jpg",
    'BARRY M. GOLDWATER': "presidentImages/goldwater.jpg",
    'ADLAI E. STEVENSON': "presidentImages/stevenson.jpg",
    'JOHN F KENNEDY': "presidentImages/jfk.jpg",
    'DWIGHT D. EISENHOWER': "presidentImages/eisenhower.jpg",
    'WENDELL WILLKIE': "presidentImages/wilkie.jpg",
    'FRANKLIN D. ROOSEVELT': "presidentImages/fdr.jpg",
    'THOMAS E. DEWEY': "presidentImages/dewey.png",
    'HARRY S TRUMAN': "presidentImages/truman.jpg"
}

const XYvals = {
        'Alabama': [7,6], 
        'Alaska': [0,0], 
        'Arizona': [2,5], 
        'Arkansas': [5,5], 
        'California': [1,4],

        'Colorado': [3,4], 
        'Connecticut': [10,3], 
        'Delaware': [9,5], 
        'Florida': [9,7], 
        'Georgia': [8,6],

        'Hawaii': [1,7], 
        'Idaho': [2,2], 
        'Illinois': [6,2], 
        'Indiana': [6,3], 
        'Iowa': [5,3],

        'Kansas': [4,5], 
        'Kentucky': [6,4], 
        'Louisiana': [5,6], 
        'Maine': [11,0], 
        'Maryland': [9,4],

        'Massachusetts': [11,2], 
        'Michigan': [8,2], 
        'Minnesota': [5,2], 
        'Mississippi': [6,6], 
        'Missouri': [5,4],

        'Washington, D.C.': [10,4],
        'Dist. of Col.': [10,4],

        'Montana': [3,2], 
        'Nebraska': [4,4], 
        'Nevada': [2,3], 
        'New Hampshire': [11,1], 
        'New Jersey': [9,3],

        'New Mexico': [3,5], 
        'New York': [9,2], 
        'North Carolina': [7,5], 
        'North Dakota': [4,2], 
        'Ohio': [7,3],

        'Oklahoma': [4,6], 
        'Oregon': [1,3], 
        'Pennsylvania': [8,3], 
        'Rhode Island': [10,2], 
        'South Carolina': [8,5],

        'South Dakota': [4,3], 
        'Tennessee': [6,5], 
        'Texas': [4,7], 
        'Utah': [2,4], 
        'Vermont': [10, 1],

        'Virginia': [8,4], 
        'Washington': [1,2], 
        'West Virginia': [7,4], 
        'Wisconsin': [7,2], 
        'Wyoming': [3,3]

    };

var year = 2016;

function dataChanging(value) {
    year = value;
    d3.csv("electionResults/election-results-" + year + ".csv",function (data) {
        console.log(data);
        dataDoing(data);
    });
}

d3.csv("electionResults/election-results-" + year + ".csv",function (data) {
  console.log(data);
  dataDoing(data);
});

d3.csv("electionResults/yearwise-winner.csv",function (data) {
    for (let i = 0; i < data.length; i++) {
        if (data[i].PARTY == "D") {
           document.getElementById(data[i].YEAR + "Button").style.backgroundColor = "blue";
        }
        else {
            document.getElementById(data[i].YEAR + "Button").style.backgroundColor = "red";
        }
    }
});
  // var xAxis = d3.axisBottom(d3.scaleLinear().domain([0,10]).range([0,canvasW-150]));
  // var yAxis = d3.axisLeft(d3.scaleLinear().domain([10,0]).range([0,canvasH-150]));
  // xAxis.tickSize(1);
  // yAxis.tickSize(10);
  
  var svg = d3.select("body").append("svg")

    .attr("width",canvasW)
    .attr("height", canvasH);

// for (var i = 1940; i <= 2016; i = i+4) {
//     let democrat = 0;
//     let republican = 0;
//     d3.csv("election-results-" + i + ".csv",function (data) {
        
//         for (let j = 0; j < data.length; j++) {
//             if (data[j].D_Votes > data[j].R_Votes) {
//                 democrat = democrat + +data[j].Total_EV;
//             }
//             else {
//                 republican = republican + +data[j].Total_EV
//             }
//         }
        
        
//     });
//     console.log(democrat);
//     console.log(republican);
//     console.log(i);
//     if (democrat > republican) {
//         document.getElementById(i + "Button").style.backgroundColor = "blue";
//     }
//     else {
//         document.getElementById(i + "Button").style.backgroundColor = "red";
//     }
    
    
// }    
    

function dataDoing(data) {
    for (let i = 0; i < data.length; i++) {
        var col = "#000000";
        console.log(data[i].State);
        console.log(XYvals[data[i].State]);
        var strokewid = 0;
        // if(data[i].D_Percentage > data[i].R_Percentage) {
        //  var col = "#0000FF";
        // }
        // else {
            var col = d3.rgb(128+ +(data[i].R_Percentage-data[i].D_Percentage)*7,50,128-(data[i].R_Percentage-data[i].D_Percentage)*7);
        //}
        var difference = data[i].R_Percentage - data[i].D_Percentage
        if (difference > 50) {
            col = d3.rgb(136,0,0);
        }
        else if (difference > 40) {
            col = d3.rgb(167,11,11);
        }
        else if (difference > 30) {
            col = d3.rgb(224, 42, 27);
        }
        else if (difference > 20) {
            col = d3.rgb(253,105,67);
        }
        else if (difference > 10) {
            col = d3.rgb(254, 146, 110);
        }
        else if (difference > 0) {
            col = d3.rgb(253,187,159);
        }
        else if (difference > -10) {
            col = d3.rgb(197, 219, 240);
        }
        else if (difference > -20) {
            col = d3.rgb(157,202,226);
        }
        else if (difference > -30) {
            col = d3.rgb(104, 173, 216);
        }
        else if (difference > -20) {
            col = d3.rgb(44,129,191);
        }
        else if (difference > -30) {
            col = d3.rgb(0, 79, 158);
        }
        else {
            col = d3.rgb(1,60,122);
        }

        var stateGroup = svg.append("g");

        var stateRect = stateGroup
            .append("rect")
            .attr("x", XYvals[data[i].State][0]*50)
            .attr("y", XYvals[data[i].State][1]*50)
            .attr("width", 50)
            .attr("height", 50)
            .attr("class", function(d) {
                var c = "Hey";
                return c;
            });
            //.text(function(d){return data[i].Abbreviation + '\n'+ data[i].Total_EV})
            //.attr("x", XYvals[data[i].State][0]*50)
            //.attr("y", XYvals[data[i].State][1]*50+25)

        var stateText = stateGroup.append("text").style("fill","black")
            .attr("x", XYvals[data[i].State][0]*50)
            .attr("y", XYvals[data[i].State][1]*50+25);
            

        stateText.text(data[i].Abbreviation)
            .append("tspan").attr("x", stateText.attr("x")).attr('dy', '1.1em')
            .text(data[i].Total_EV);
        
        stateGroup.on("mouseover", function() {
            console.log(i);
            var candidateGroup = stateGroup.append("g").attr("id","T").attr("x", XYvals[data[i].State][0]*50+50).attr("y", XYvals[data[i].State][1]*50);

            

            var candidateBox = candidateGroup.append("rect").attr("fill","#FFFF00") 
            .attr("x", XYvals[data[i].State][0]*50+50).attr("y", XYvals[data[i].State][1]*50).attr("width", 300).attr("height",180).attr("fill","#FFFF00");

             var candidateText = candidateGroup.append("text").attr("id","T").style("fill","black");

            candidateText.text(data[i].State + ": " + data[i].Total_EV + " electoral votes")
            .attr("font-size", "20px")
            .attr("x", candidateGroup.attr("x"))
            .attr("y", 25 + +candidateGroup.attr("y"))
            .append("tspan").attr("font-size", "12px").attr('dy', '1.1em').attr("x", 65 + +candidateGroup.attr("x"))
            .text(data[i].D_Nominee + ", " + data[i].D_Votes + " (" + data[i].D_Percentage + "%)")
            .append("tspan").attr('dy', '7em').attr("x", 65 + +candidateGroup.attr("x"))
            .text(data[i].R_Nominee + ", " + data[i].R_Votes + " (" + data[i].R_Percentage + "%)");
            var imageDem = candidateGroup.append("svg:image")
                .attr('x', candidateGroup.attr("x"))
                .attr('y', 30 + +candidateGroup.attr("y"))
                .attr('width', 60)
                .attr('height', 75)
                .attr("xlink:href", images[data[i].D_Nominee]);  
            var imageRep = candidateGroup.append("svg:image")
                .attr('x', candidateGroup.attr("x"))
                .attr('y', 105 + +candidateGroup.attr("y"))
                .attr('width', 60)
                .attr('height', 75)
                .attr("xlink:href", images[data[i].R_Nominee]);
                //console.log(data[i].group + ", " + data[i].test);
            })
            .on("mouseout", function() {
                d3.selectAll("#T").remove();
            })
            
            .style("fill", col)
            .style("stroke", "#000000")
            .style("stroke-width", strokewid);

    }
};

var imageLegend = svg.append("svg:image")
                .attr('x', 0)
                .attr('y', 400)
                .attr('width', 600)
                .attr('height', 75)
                .attr("xlink:href", "presidentImages/electoralmap-legend.png");


        </script>
    </body>
</html>
